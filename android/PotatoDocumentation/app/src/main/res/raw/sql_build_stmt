CREATE TABLE IF NOT EXISTS `feld` (
  `feld_id` int(11) NOT NULL,
  `row_nr` int(11) NOT NULL,
  `column_nr` int(11) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`feld_id`)
);
CREATE UNIQUE INDEX `row_column_integrity` ON `feld`(`row_nr`,`column_nr`);
CREATE TABLE IF NOT EXISTS `sorte` (
  `sort_name` varchar(255) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`sort_name`)
);
CREATE TABLE IF NOT EXISTS `parzellen` (
  `parz_id` int(11) NOT NULL,
  `feld_nr` int(11) NOT NULL,
  `sorte` varchar(255) DEFAULT NULL,
  `parz_row` int(11) NOT NULL,
  `parz_col` int(11) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`parz_id`),
  CONSTRAINT `parzellen_ibfk_1` FOREIGN KEY (`sorte`) REFERENCES `sorte` (`sort_name`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `parzellen_ibfk_2` FOREIGN KEY (`feld_nr`) REFERENCES `feld` (`feld_id`) ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE UNIQUE INDEX `row_col_unique` ON `parzellen`(`parz_row`,`parz_col`,`feld_nr`);
CREATE TABLE IF NOT EXISTS `eigenschaft` (
  `eig_name` varchar(255) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`eig_name`)
);
CREATE TABLE IF NOT EXISTS `aufgabe` (
  `aufg_name` varchar(255) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`aufg_name`)
);
CREATE TABLE IF NOT EXISTS `aufg_beinhaltet_eig` (
  `aufg_name` varchar(255) NOT NULL,
  `eig_name` varchar(255) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`aufg_name`,`eig_name`),
  CONSTRAINT `aufg_beinhaltet_eig_ibfk_1` FOREIGN KEY (`aufg_name`) REFERENCES `aufgabe` (`aufg_name`) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT `aufg_beinhaltet_eig_ibfk_2` FOREIGN KEY (`eig_name`) REFERENCES `eigenschaft` (`eig_name`) ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE TABLE IF NOT EXISTS `aufg_gehoert_zu_parz` (
  `aufg_name` varchar(255) NOT NULL,
  `parz_id` int(11) NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`aufg_name`,`parz_id`),
  CONSTRAINT `aufg_gehoert_zu_parz_ibfk_1` FOREIGN KEY (`aufg_name`) REFERENCES `aufgabe` (`aufg_name`) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT `aufg_gehoert_zu_parz_ibfk_2` FOREIGN KEY (`parz_id`) REFERENCES `parzellen` (`parz_id`) ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE TABLE IF NOT EXISTS `aufg_termin` (
  `aufg_name` varchar(255) NOT NULL,
  `fromDate` date NOT NULL,
  `toDate` date NOT NULL,
  `updated` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`aufg_name`,`fromDate`,`toDate`),
  CONSTRAINT `aufg_termin_ibfk_1` FOREIGN KEY (`aufg_name`) REFERENCES `aufgabe` (`aufg_name`) ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE TABLE IF NOT EXISTS `variante` (
   `var_name` varchar(255) PRIMARY KEY
);
CREATE TABLE IF NOT EXISTS `partner` (
  `firmname` varchar(255) NOT NULL ,
   `id` int(11) PRIMARY KEY,
   `standort` varchar(255) NOT NULL
);
CREATE TABLE IF NOT EXISTS `versuch`(
  `name` varchar(255) NOT NULL,
  `versuchsnr` int(11) PRIMARY KEY,
  `jahr` YEAR NOT NULL,
  `partner_id` int(11) NOT NULL,
  INDEX (`partner_id`),
  CONSTRAINT `partner_fk2`FOREIGN KEY(`partner_id`) REFERENCES `partner`(`id`)ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE TABLE IF NOT EXISTS `versuch_beinhaltet_var`(
    `versuchs_nr` int(11) NOT NULL,
    `variante` varchar(255) NOT NULL,
    `legedatum` date NOT NULL,
    `pflanzenanzahl` int(4) NOT NULL,
    PRIMARY KEY(`versuchs_nr`,`variante`),
    CONSTRAINT `versuchsnr_fk1` FOREIGN KEY(`versuchs_nr`) REFERENCES `versuch` (`versuchsnr`) ON DELETE NO ACTION ON UPDATE CASCADE,
    CONSTRAINT `var_name_fk2` FOREIGN KEY(`variante`) REFERENCES `variante` (`var_name`) ON DELETE NO ACTION ON UPDATE CASCADE
);
CREATE TABLE IF NOT EXISTS `wiederholung` (
    `versuchs_nr` int(11) NOT NULL,
    `wiederholung` char(1) NOT NULL,
    `feld_nr` int(11) NOT NULL,
    `parz_nr` int(11) NOT NULL,
    PRIMARY KEY (`versuchs_nr`,`wiederholung`),
    INDEX (`feld_nr`),
    INDEX (`parz_nr`),
    CONSTRAINT `versuchs_nr_fk1` FOREIGN KEY(`versuchs_nr`) REFERENCES `versuch`(`versuchsnr`) ON DELETE NO ACTION ON UPDATE CASCADE,
    CONSTRAINT `feld_nr_fk2` FOREIGN KEY(`feld_nr`) REFERENCES `feld` (`feld_id`) ON DELETE NO ACTION ON UPDATE CASCADE,
    CONSTRAINT `parz_nr_fk3` FOREIGN KEY(`parz_nr`) REFERENCES `parzellen`(`parz_id`) ON DELETE NO ACTION ON UPDATE CASCADE
);